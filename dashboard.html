<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>數位儀表板</title>
    <!-- 引入 Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入自定義 CSS -->
    <link href="assets/styles.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <a href="index.html" class="btn btn-primary" style="float: right; margin-top: 20px;">回首頁</a>
        <h1 class="text-center text-primary mt-5">Stock Dashboard</h1>
        
        <!-- 動態圖表 -->
        <div id="price-chart" class="mt-4"></div>
        <div id="indicator-chart" class="mt-4"></div>
    </div>

    <!-- 引入 Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- 自定義 JavaScript -->
    <script>
        // 獲取數據
        fetch('data/stock_data.json')
            .then(response => response.json())
            .then(data => {
                // 繪製收盤價圖表
                var priceTrace = {
                    x: data.dates,
                    y: data.close,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '收盤價',
                    line: { color: '#17BECF' }
                };

                var priceLayout = {
                    title: '股票收盤價',
                    xaxis: { title: '日期' },
                    yaxis: { title: '價格 (TWD)' },
                    template: 'plotly_dark'
                };

                Plotly.newPlot('price-chart', [priceTrace], priceLayout);

                // 繪製 RSI 圖表
                var rsiTrace = {
                    x: data.dates,
                    y: data.rsi,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'RSI',
                    line: { color: '#FF5733' }
                };

                var rsiLayout = {
                    title: '相對強弱指數 (RSI)',
                    xaxis: { title: '日期' },
                    yaxis: { title: 'RSI', range: [0, 100] },
                    shapes: [
                        // 畫出 70 和 30 的參考線
                        {
                            type: 'line',
                            x0: data.dates[0],
                            y0: 70,
                            x1: data.dates[data.dates.length - 1],
                            y1: 70,
                            line: {
                                color: 'red',
                                width: 1,
                                dash: 'dashdot'
                            }
                        },
                        {
                            type: 'line',
                            x0: data.dates[0],
                            y0: 30,
                            x1: data.dates[data.dates.length - 1],
                            y1: 30,
                            line: {
                                color: 'green',
                                width: 1,
                                dash: 'dashdot'
                            }
                        }
                    ],
                    template: 'plotly_dark'
                };

                Plotly.newPlot('indicator-chart', [rsiTrace], rsiLayout);
            })
            .catch(error => {
                console.error('無法加載圖表數據:', error);
                document.getElementById('price-chart').innerHTML = '<p class="text-danger">無法加載圖表數據。</p>';
                document.getElementById('indicator-chart').innerHTML = '<p class="text-danger">無法加載圖表數據。</p>';
            });
    </script>

    <!-- 引入 Bootstrap JS 和依賴 -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
